<script>
  function give_folders(){
    google.script.run.withSuccessHandler(give_students_who_doesnt_have_folder_folder).importCSVFromGoogleDrive("https://docs.google.com/spreadsheets/d/1GwEl7OViaC6z6P4Msf4mkjCr1Fv1K3NQX7O1rWwO7J0/edit#gid=0", 0);
  }
  
  
//  var datax;
//  var link_index;
//  var first_name_index, last_name_index, uin_index;
//  var j;
  
  function give_students_who_doesnt_have_folder_folder(data){
    var link_index = data[0].length - 1;
    var first_name_index, last_name_index, uin_index;
    
    for(var i = 0; i < data[0].length; i++){
      if(data[0][i].includes("First") || data[0][i].includes("first") || data[0][i].includes("FIRST")){
        first_name_index = i;
      }
      
      if(data[0][i].includes("Last") || data[0][i].includes("last") || data[0][i].includes("LAST")){
        last_name_index = i;
      }
      
      if(data[0][i].includes("uin") || data[0][i].includes("Uin") || data[0][i].includes("UIN")){
        uin_index = i;
      }
    }
    
    console.log(link_index);
    
//    for(var i = 0; i < data.length; i++){
//      if(data[i][link_index] == " " || data[i][link_index] == ""){
//        console.log(data[i][first_name_index] + data[i][last_name_index] + data[i][uin_index]);
//        google.script.run.alll(data[i][first_name_index], data[i][last_name_index], data[i][uin_index]);
//      }
//    }

    google.script.run.test(data[i][first_name_index], data[i][last_name_index], data[i][uin_index]);
  }
  
  var j = 0;
  
  function temp(data){
    datax = data;
//  console.log("inside");
    var link_index = data[0].length - 1;
    var first_name_index, last_name_index, uin_index;
    
    for(var i = 0; i < data[0].length; i++){
      if(data[0][i].includes("First") || data[0][i].includes("first") || data[0][i].includes("FIRST")){
        first_name_index = i;
      }
      
      if(data[0][i].includes("Last") || data[0][i].includes("last") || data[0][i].includes("LAST")){
        last_name_index = i;
      }
      
      if(data[0][i].includes("uin") || data[0][i].includes("Uin") || data[0][i].includes("UIN")){
        uin_index = i;
      }
    }
    
    console.log(link_index);
    
//    for(var i = 0; i < data.length; i++){
//      if(data[i][link_index] == " " || data[i][link_index] == ""){
////        google.script.run.alll(data[i][first_name_index], data[i][last_name_index], data[i][uin_index]);
//
//        google.script.run.withSuccessHandler(function(folder_exist){
//          while(folder_exist == false){
//            google.script.run.alll(datax[j][first_name_index], datax[j][last_name_index], datax[j][uin_index]);
//          }
//  }).is_folder_exist(datax[j][first_name_index], datax[j][last_name_index], datax[j][uin_index]);
//
//      }
//    }

//    if(data[1][link_index] == " " || data[1][link_index] == ""){
//      console.log("empty");
//    }
//    else{
//      console.log("not empty");
//    }
//    
    while(j >= 0 && j < data.length){
//      console.log(j);
      if(data[j][link_index] == " " || data[j][link_index] == ""){
        console.log(j + " index doesn't have folder link");
        google.script.run.alll(data[j][first_name_index], data[j][last_name_index], data[j][uin_index]);
        j++;
        var done = true;
//        while(done){
//          console.log("dsfgdf");
//          google.script.run.withSuccessHandler(function(res){
//            console.log("printing res " + res);
//            if(res == true){
//              j++;
//              done = false;
//            }
////            else{
////              setTimeout(pollDOM, 300);
////            }
//          }).is_folder_exist(data[j][first_name_index], data[j][last_name_index], data[j][uin_index]);
          
//          setTimeout(pollDOM, 300);
//        }
        

//        google.script.run.withSuccessHandler(function(folder_exist){
//          while(folder_exist == false){
//            google.script.run.alll(datax[j][first_name_index], datax[j][last_name_index], datax[j][uin_index]);
//          }
//  }).is_folder_exist(datax[j][first_name_index], datax[j][last_name_index], datax[j][uin_index]);

      }
      else{
        j++;
      }
      
    }
//    setTimeout(pollDOM, 300);
  }
  
  
  
  function testt(){
    google.script.run.withSuccessHandler(function(res){
            console.log("printing res" + res);
//            if(res == true){
//              j++;
//              done = false;
//            }
          }).is_folder_exist("tom", "jerry", "1");
  }
  
  
  
  
  
  
</script>

