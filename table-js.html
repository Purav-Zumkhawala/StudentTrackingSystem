<script>
  document.addEventListener("DOMContentLoaded", function(){
    google.script.run.withSuccessHandler(generate_table).importCSVFromGoogleDrive();
  });

  function generate_table(data){
    var table_div = document.getElementById("tb");
    
    var table = document.createElement("table");
    table.className = "table table-striped";
    
    var table_header_row = document.createElement("tr");
    
    for(var i = 0; i < data[0].length; i++){
      var header = document.createElement("th");
//      header.style.scope = "col";
      header.textContent = data[0][i];
      table_header_row.appendChild(header);
    }
    
    table.appendChild(table_header_row);
    table_div.appendChild(table);
    
    var num_rows = data.length;
    data.splice(0, 1);
  
    data.forEach(function(rows){
      var row = document.createElement("tr");
      
      for(var i = 0; i < data[0].length; i++){
        var table_data = document.createElement("td");
        table_data.textContent = rows[i];
        row.appendChild(table_data);
        
      }
      table.appendChild(row);
      
    });
    
    table_div.appendChild(table);
  }

</script>
